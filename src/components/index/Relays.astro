---
/**
 * Relays 组件 - 社区 Relay 展示
 */
import { ExternalLink } from "@lucide/astro";
import Badge from "../ui/Badge.astro";
import Card from "../ui/Card.astro";
import CopyButton from "./CopyButton";
import JoinCommunity from "./JoinCommunity";

const RELAY_URL = "wss://relay.nostrzh.org/";
const jumbleUrl = `https://jumble.social?r=${encodeURIComponent(RELAY_URL)}`;
---

<section id="relay" class="py-24 relative overflow-hidden">
  {/* 背景装饰 */}
  <div class="absolute inset-0 bg-bg-secondary"></div>
  <div class="absolute inset-0 bg-gradient-glow-purple opacity-30"></div>

  <div class="max-w-4xl mx-auto px-6 relative">
    <div class="text-center mb-12">
      <h2 class="text-3xl md:text-4xl font-bold text-text-primary mb-4">
        加入社区
      </h2>
      <p class="text-lg text-text-secondary max-w-2xl mx-auto">
        连接到我们的 Relay，加入中文 Nostr 社区
      </p>
    </div>

    <Card
      variant="elevated"
      padding="lg"
      hoverable={false}
      className="max-w-none!"
    >
      {/* 标题栏 */}
      <div class="flex items-center justify-between mb-6">
        <h3 class="text-xl font-semibold text-text-primary">
          Nostr 中文社区 Relay
        </h3>
        <Badge variant="primary" size="sm" dot>邀请制</Badge>
      </div>

      {/* 描述 */}
      <p class="text-text-secondary mb-6 leading-relaxed">
        邀请制中文社区 Relay，聚集 Nostr
        上的中文用户，打造高质量的中文社交空间。
      </p>

      {/* Relay 地址卡片 */}
      <div
        class="flex items-center max-sm:flex-wrap gap-3 p-4 bg-bg-tertiary rounded-lg border border-border mb-6"
      >
        <code
          class="flex-1 text-sm text-primary-600 dark:text-primary-400 font-mono truncate"
        >
          {RELAY_URL}
        </code>
        <div class="flex items-center gap-2 max-sm:w-full">
          <a
            href={jumbleUrl}
            target="_blank"
            rel="noopener noreferrer"
            class="px-4 py-2 flex items-center justify-center max-sm:flex-1 gap-2 text-sm shrink-0 cursor-pointer bg-bg-card border border-border hover:border-primary-500 text-text-secondary hover:text-primary-600 dark:hover:text-primary-400 rounded-lg transition-all duration-200"
          >
            浏览
            <ExternalLink class="size-4" />
          </a>
          <CopyButton
            text={RELAY_URL}
            className="max-sm:flex-1"
            client:visible
          />
        </div>
      </div>

      {/* 加入表单 */}
      <JoinCommunity client:visible />
    </Card>
  </div>
</section>
